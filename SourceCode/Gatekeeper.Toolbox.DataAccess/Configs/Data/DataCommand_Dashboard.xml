<?xml version="1.0" encoding="utf-8" ?>
<DataOperators xmlns="https:\\Gatekeeper\Framework\DataOperators">
  <DataCommand Name="Dashboard.FetchGivingData" DataSourceID="DashboardDB" Type ="TextCommand">
    <CommandText>
      <![CDATA[
        SELECT 
	        Giving.[Church_Id] as ChurchId,
	        widgetItem.[UserWidgetItemID] as WidgetItemId,
	        Giving.[SummaryNumber],
	        Giving.[CountNumber],
	        Giving.[Date]
        FROM [ChmContribution].[dbo].[View_Contribution_GetGivingData] as Giving (NOEXPAND)
		    LEFT JOIN [ChmDashboard].[dbo].[UserWidgetItem] as widgetItem WITH(NOLOCK)
		      ON widgetItem.WidgetItemReferId = Giving.[Fund_Id]
        WHERE Giving.[Church_Id] = @ChurchId
          AND Giving.[Date] > @StartDate 
          AND Giving.[Date] < @EndDate
          #WhereStr#
        ORDER BY Giving.[Date] ASC
      ]]>
    </CommandText>
    <Parameters>
      <Param Name="@ChurchId" DBType="Int32" Size="4" />
      <Param Name="@StartDate" DBType="DateTime" Size="20" />
      <Param Name="@EndDate" DBType="DateTime" Size="20" />
    </Parameters>
  </DataCommand>
</DataOperators>